# Данные анализа производительности распространённых сетей

## 1. Предисловие

### 1.1 Целевая аудитория

Этот документ (это руководство) предназначен в основном для следующих людей:

• Инженеры технической поддержки

• Инженеры разработки программного обеспечения

• Клиенты AI приложений

## 2. Основное содержание

### 2.1 Введение в разработку NPU

• Поддерживает квантизацию с точностью int8/uint8/int16, вычислительная производительность может достигать 1TOPS.

• По сравнению с крупными решениями на базе чипов, использующих GPU в качестве вычислительного блока AI, потребление мощности составляет менее 1% необходимого для GPU.

• Может напрямую импортировать форматы моделей Caffe, TensorFlow, Onnx, TFLite, Keras, Darknet, pyTorch и т.д.

• Предоставляет инструменты разработки AI: поддерживает быстрое преобразование моделей, поддерживает API преобразования на стороне отладочной платы, поддерживает модели TensorFlow, TF Lite, Caffe, ONNX, Darknet, pyTorch и т.д.

• Предоставляет интерфейсы разработки приложений AI: предоставляет кроссплатформенный API NPU.

### 2.2 Процесс разработки

Полный процесс разработки NPU показан на рисунке ниже:

![image-20221208105235547](http://photos.100ask.net/allwinner-docs/v853/AIApplication/image-20221208105235547.png)

<center>Рисунок 2-1: npu_1.png</center>

### 2.3 Эталоны распространённых сетей

![image-20221208105336553](http://photos.100ask.net/allwinner-docs/v853/AIApplication/image-20221208105336553.png)

<center>Рисунок 2-2: NPU benchmark</center>

Приведённые выше данные получены путём запуска сетей на голом железе и не учитывают других приложений в решении.

### 2.4 Данные анализа памяти

Анализ потребления памяти в сценарии использования решения приложения.

Использование кода и данных, включая пространство, занимаемое самим KMD и UMD, составляет приблизительно 180k.

<center>Таблица 2-1: размер занимаемого кода</center>

|        | text                     | data             | bss            | Всего  |
| :----: | ------------------------ | ---------------- | -------------- | ------ |
| Режим ядра | 55164                    | 920              | 388            | 56472  |
| Пространство пользователя | 99739+22656              | 604+484          | 388+72         | 123943 |
| Всего  | 99739+22656+55164=177559 | 608+484+920=2008 | 388+72+388=848 | 180415 |

Статистика памяти для модели Yolov3, потребление памяти во время выполнения составляет примерно 48M.

<center>Таблица 2-2: статистика памяти yolov3</center>

|      | total video memory | total system memory | viplite driver code size | Всего   |
| :--: | :----------------: | :-----------------: | :----------------------: | :------: |
| Размер |      48460032      |        81500        |          180415          | 48721947 |
| Доля |       99.46%       |        0.17%        |          0.37%           |   100%   |

Статистика памяти для модели yolov3-tiny, потребление памяти во время выполнения составляет примерно 6.8M.

<center>Таблица 2-3: статистика памяти yolov3-tiny</center>

|      | total video memory | total system memory | viplite driver code size | Всего  |
| :--: | :----------------: | :-----------------: | :----------------------: | :-----: |
| Размер |      6710784       |        20596        |          180415          | 6911795 |
| Доля |      97.092%       |       0.307%        |          2.61%           |  100%   |

Данные по частоте кадров, полосе пропускания и т.д. будут добавлены позже.
